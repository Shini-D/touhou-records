---
import { getRelativeLocaleUrl } from 'astro:i18n';
import Logo from '@/assets/logo.svg';
import NavigationMenu from '@/components/NavigationMenu.astro';
import AccordionItem from '@/components/AccordionItem.astro';
import {SOCIAL} from '@/consts/social';
import * as Texts from '@/assets/common.json';

const locale = (Astro.currentLocale as "en" | "es") || "en";
const texts = Texts[locale];
---

<footer class="bg-pearl-400 dark:bg-dark-500">
  <div class="max-w-8xl mx-auto px-7 py-10 lg:py-16 flex flex-col lg:flex-row gap-7 lg:gap-8 2xl:gap-10">
    <div class="lg:w-1/4">
      <Logo class="fill-dark-700 dark:text-light mb-6 lg:mb-4 mx-auto lg:mx-0 h-12 w-auto"/>
      <ul class="flex gap-2 justify-center lg:justify-start">
        {SOCIAL.map(({name, url, icon}) => (
          <li>
            <a
              href={url}
              target="_blank"
              rel="noopener noreferrer"
              aria-label={name}
              class="block p-2 rounded bg-primary-100 hover:bg-primary-50 text-white transition-colors"
            >
              <icon.image class="size-6" />
            </a>
          </li>
        ))}
      </ul>
    </div>
    <div class="hidden lg:block w-1/4">
      <h3 class="font-bold text-2xl leading-tight text-night dark:text-light mb-6">{texts.sitemap}</h3>
      <NavigationMenu classes="flex flex-col gap-2" hasActive={false} />
    </div>
    <div class="hidden lg:block w-1/4">
      <h3 class="font-bold text-2xl leading-tight text-night dark:text-light mb-6">{texts.latestPosts}</h3>
      Posts
    </div>
    <div class="hidden lg:block w-1/4">
      <h3 class="font-bold text-2xl leading-tight text-night dark:text-light mb-6">{texts.credits}</h3>
      <a href={getRelativeLocaleUrl(Astro.currentLocale as string, '/site-images')} class="hover:text-primary-100 transition-colors">{texts.siteImages}</a>
    </div>

    <ul class="flex flex-col gap-2 lg:hidden">
      <AccordionItem title={texts.sitemap}>
        <NavigationMenu classes="flex flex-col gap-2" hasActive={false} />
      </AccordionItem>
      <AccordionItem title={texts.latestPosts}>
        Posts list
      </AccordionItem>
      <AccordionItem title={texts.credits}>
        <a href={getRelativeLocaleUrl(Astro.currentLocale as string, '/site-images')} class="hover:text-primary-100 transition-colors">{texts.siteImages}</a>
      </AccordionItem>
    </ul>
  </div>
  <p class="px-7 py-4 border-t border-pearl-600 dark:border-dark-300 text-center">
    Â© {new Date().getFullYear()} Touhou Records.
  </p>
</footer>

<script>
  document.addEventListener("astro:page-load", () => {
    const accTriggers = document.querySelectorAll('.acc-trigger');

    if (accTriggers.length > 0){
      accTriggers.forEach(trigger => {
        trigger.addEventListener('click', () => {
          trigger.classList.toggle('active');
        });
      });

      window.addEventListener('resize', () => {
        accTriggers.forEach(trigger => {
          if (window.innerWidth > 1088) {
            trigger.classList.remove('active');
          }
        });
      })
    }
  });
</script>
